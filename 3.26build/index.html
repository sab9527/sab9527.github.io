<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta property="og:title" content="流亡黯道 3.26 拓荒流派 by Sab">
    <meta property="og:description" content="拓荒流派整理和推薦 不負責任">
    <meta property="og:image" content="https://i.imgur.com/e9zIVsm.png">
    <meta property="og:url" content="https://sab9527.github.io/3.26build/index.html">



    <title>Path of Exile-3.26 Starter Build< sab</title>
    <style>
        body {
            font-family: 'Segoe UI', '微軟正黑體', Arial, sans-serif;
            margin: 0;
            /* 請將下行網址替換為你想要的圖片網址 */
            background: #181c20 url('https://upload-os-bbs.hoyolab.com/upload/2023/05/10/248389752/f169af109b5d93fc3c884170d2213c09_6832829586940383967.jpg?x-oss-process=image%2Fresize%2Cs_1000%2Fauto-orient%2C0%2Finterlace%2C1%2Fformat%2Cwebp%2Fquality%2Cq_70') no-repeat center center fixed;
            background-size: cover;
            color: #e0e0e0;
            min-height: 100vh;
        }
        h2 {
            text-align: center;
            margin-top: 32px;
            color: #f5dbb5;
            letter-spacing: 2px;
            text-shadow: 0 2px 8px #000a;
        }
        .upload-block {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 24px 0 0 0;
        }
        .upload-block label {
            background: #23272e;
            color: #ffb84d;
            border-radius: 8px;
            padding: 8px 18px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 12px;
            border: 1.5px solid #ffb84d;
            transition: background 0.2s, color 0.2s;
        }
        .upload-block input[type="file"] {
            display: none;
        }
        .filter-group {
            margin: 32px auto 24px auto;
            padding: 24px 32px;
            background: #263c61;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(45, 219, 196, 0.986);
            max-width: 900px;
            display: flex;
            flex-wrap: wrap;
            gap: 24px 32px;
            justify-content: flex-start !important;
        }
        .filter-block {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: nowrap;   /* 新增：同一行不換行 */
            justify-content: flex-start !important;
        }
        .filter-block.damage-type-block {
            white-space: nowrap;
        }
        .filter-label {
            color: #ffb84d;
            font-weight: bold;
            margin-right: 8px;
            white-space: nowrap; /* 新增：防止換行 */
        }
        .filter-btn {
            background: #23272e;
            color: #e0e0e0;
            border: 1.5px solid #444;
            border-radius: 6px;
            padding: 4px 14px;
            margin: 2px 2px;
            cursor: pointer;
            transition: background 0.2s, color 0.2s, border 0.2s;
            font-size: 15px;
        }
        .filter-btn.active {
            background: #ffb84d;
            color: #23272e;
            border: 1.5px solid #ffb84d;
            font-weight: bold;
            box-shadow: 0 2px 8px #ffb84d44;
        }
        table {
            width: 96%;
            margin: 0 auto 40px auto;
            border-collapse: collapse;
            background: #23272e;
            box-shadow: 0 4px 24px #0008;
            border-radius: 12px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #333a;
            padding: 10px 8px;
            text-align: center;
        }
        td {
            white-space: nowrap; /* 禁止換行 */
            overflow: hidden;    /* 隱藏超出部分 */
            text-overflow: ellipsis; /* 超出部分顯示省略號 */
        }

        td:last-child {
            white-space: normal; /* 允許換行 */
        }
        th {
            background: #1a1e23;
            color: #ffb84d;
            font-size: 16px;
            letter-spacing: 1px;
            white-space: nowrap;
        }
        tr:nth-child(even) {
            background: #23272e;
        }
        tr:nth-child(odd) {
            background: #181c20;
        }
        .video-embed {
            width: 220px;
            height: 124px;
            border-radius: 6px;
            border: none;
            background: #111;
        }
        a { color: #7ecfff; text-decoration: underline; }
        a:hover { color: #ffb84d; }
        @media (max-width: 900px) {
            .filter-group { flex-direction: column; align-items: stretch; }
            table, th, td { font-size: 13px; }
            .video-embed { width: 140px; height: 80px; }
        }
        tbody.fade {
            opacity: 0;
            transition: opacity 0.3s;
        }
        tbody {
            transition: opacity 0.3s;
        }
        .sub-ascendancy-outer {
         width: 100%;
         display: flex;
         align-items: center;
         /* 其餘動畫屬性保持不變 */
         overflow: hidden;
         max-height: 0;
         transition: max-height 0.35s cubic-bezier(0.4,0,0.2,1), opacity 0.35s;
         opacity: 0;
         margin: 0 0 0 0;
        }
        .sub-ascendancy-outer.show {
            max-height: 500px; /* 足夠容納內容的最大高度 */
            opacity: 1;
        }
    </style>
</head>
<body>
    <h2>Path of Exile-3.26 Starter Build</h2>
    <div style="display:none;"></div>
    <div class="filter-group" id="filter-group"></div>
    <table id="games-table">
        <thead>
            <tr>
                <th>流派名稱</th>
                <th>昇華</th>
                <th>擅長分類</th>
                <th>傷害類型</th>
                <th>作者</th>
                <th>影片連結</th>
                <th>說明</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <div id="video-modal-mask" style="display:none;position:fixed;z-index:10000;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);justify-content:center;align-items:center;">
        <div id="video-modal-content" style="position:relative;background:none;">
            <span id="video-modal-close" style="position:absolute;top:-32px;right:0;font-size:32px;color:#fff;cursor:pointer;">&times;</span>
            <iframe id="video-modal-iframe" width="560" height="315" style="border-radius:12px;border:none;box-shadow:0 4px 24px #000a;background:#111;" allowfullscreen></iframe>
        </div>
    </div>
    <script>
    const ASCENDANCY_CLASSES = {
        '野蠻人': ['勇士', '暴徒', '酋長'],
        '遊俠': ['守林人', '銳眼', '追獵者'],
        '女巫': ['秘術家', '元素使', '死靈師'],
        '決鬥者': ['處刑者', '衛士', '冠軍'],
        '聖騎士': ['判官', '聖宗', '守護者'],
        '暗影刺客': ['刺客', '詐欺師', '破壞者'],
        '貴族': ['昇華使徒']
    }

    const filterOptions = {
        '職業': Object.keys(ASCENDANCY_CLASSES),
        '昇華': [], // 這裡不直接顯示
        '擅長分類': ['打王','打圖','均衡','特化'],
        '傷害類型': ['火焰','閃電','冰冷','物理','渾沌','直擊','持續','召喚','圖騰','法術','攻擊','弓']
    };
    function createModernFilters() {
        const filterGroup = document.getElementById('filter-group');
        filterGroup.innerHTML = '';

        // 1. 昇華主職業列
        const ascendancyBlock = document.createElement('div');
        ascendancyBlock.className = 'filter-block';
        const ascendancyLabel = document.createElement('span');
        ascendancyLabel.className = 'filter-label';
        ascendancyLabel.textContent = '昇華';
        ascendancyBlock.appendChild(ascendancyLabel);

        Object.keys(ASCENDANCY_CLASSES).forEach(mainClass => {
            const mainBtn = document.createElement('button');
            mainBtn.className = 'filter-btn main-class-btn';
            mainBtn.textContent = mainClass;
            mainBtn.dataset.field = '職業';
            mainBtn.dataset.value = mainClass;
            mainBtn.onclick = function() {
                // 若已選取，再點一次則取消選取
                const isActive = mainBtn.classList.contains('active');
                document.querySelectorAll('.filter-btn.active').forEach(btn => btn.classList.remove('active'));
                if (!isActive) {
                    mainBtn.classList.add('active');
                    showSubAscendancy(mainClass);
                } else {
                    showSubAscendancy(null);
                }
                renderTable(window._gameData, getCurrentFilters());
            };
            ascendancyBlock.appendChild(mainBtn);
        });
        filterGroup.appendChild(ascendancyBlock);

        // 2. 子昇華區塊（只建立一個，固定插在這裡）
        const subOuter = document.createElement('div');
        subOuter.className = 'sub-ascendancy-outer';
        subOuter.style.overflow = 'hidden';
        subOuter.style.maxHeight = '0';
        subOuter.style.transition = 'max-height 0.35s cubic-bezier(0.4,0,0.2,1), opacity 0.35s';
        subOuter.style.opacity = '0';
        subOuter.style.display = 'block';
        subOuter.style.margin = '0 0 0 0';
        filterGroup.appendChild(subOuter);

        // 3. 其他分類
        ['擅長分類', '傷害類型'].forEach(field => {
            const block = document.createElement('div');
            block.className = 'filter-block';
            if (field === '傷害類型') block.classList.add('damage-type-block');
            const label = document.createElement('span');
            label.className = 'filter-label';
            label.textContent = field;
            block.appendChild(label);
            filterOptions[field].forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.textContent = opt;
                btn.dataset.field = field;
                btn.dataset.value = opt;
                btn.onclick = function() {
                    btn.classList.toggle('active');
                    renderTable(window._gameData, getCurrentFilters());
                };
                block.appendChild(btn);
            });
            filterGroup.appendChild(block);
        });

        // 子昇華內容切換函式
        function showSubAscendancy(mainClass) {
            subOuter.innerHTML = '';
            if (!mainClass) {
                // 沒有選主職業時顯示提示
                const tip = document.createElement('div');
                tip.className = 'filter-block sub-ascendancy-block';
                tip.style.marginLeft = '0';
                tip.style.justifyContent = 'flex-start';
                tip.innerHTML = `<span class="filter-label">子昇華</span><span style="color:#aaa;">請選擇昇華</span>`;
                subOuter.appendChild(tip);
                subOuter.style.maxHeight = subOuter.scrollHeight + 'px';
                subOuter.style.opacity = '1';
                setTimeout(() => {
                    subOuter.style.maxHeight = subOuter.scrollHeight + 'px';
                    subOuter.style.opacity = '1';
                }, 10);
                return;
            }
            // 內容
            const subBlock = document.createElement('div');
            subBlock.className = 'filter-block sub-ascendancy-block';
            subBlock.style.marginLeft = '0';
            subBlock.style.justifyContent = 'flex-start';
            const label = document.createElement('span');
            label.className = 'filter-label';
            label.textContent = '子昇華';
            subBlock.appendChild(label);
            ASCENDANCY_CLASSES[mainClass].forEach(sub => {
                const subBtn = document.createElement('button');
                subBtn.className = 'filter-btn sub-ascendancy-btn';
                subBtn.textContent = sub;
                subBtn.dataset.field = '昇華';
                subBtn.dataset.value = sub;
                subBtn.onclick = function() {
                    subBtn.classList.toggle('active');
                    renderTable(window._gameData, getCurrentFilters());
                };
                subBlock.appendChild(subBtn);
            });
            subOuter.appendChild(subBlock);
            // 動畫展開
            subOuter.style.display = 'block';
            subOuter.style.opacity = '0';
            subOuter.style.maxHeight = '0';
            setTimeout(() => {
                subOuter.style.maxHeight = subOuter.scrollHeight + 'px';
                subOuter.style.opacity = '1';
            }, 10);
        }
    }
    function getCurrentFilters() {
        const filters = {};
        // 主職業
        const mainBtn = document.querySelector('.main-class-btn.active');
        if (mainBtn) {
            filters['職業'] = [mainBtn.dataset.value];
        }
        // 子昇華
        const subBtns = Array.from(document.querySelectorAll('.sub-ascendancy-btn.active'));
        if (subBtns.length > 0) {
            filters['昇華'] = subBtns.map(btn => btn.dataset.value);
        }
        // 其他
        document.querySelectorAll('.filter-btn.active:not(.main-class-btn):not(.sub-ascendancy-btn)').forEach(btn => {
            if (!filters[btn.dataset.field]) filters[btn.dataset.field] = [];
            filters[btn.dataset.field].push(btn.dataset.value);
        });
        return filters;
    }
    function matchFilters(row, filters) {
        for (let key in filters) {
            if (key === '職業') {
                // 根據昇華名稱反查職業
                const ascendancy = (row['昇華'] || '').split(/,|、/).map(s => s.trim());
                const match = ascendancy.some(sub =>
                    filters['職業'].some(main =>
                        ASCENDANCY_CLASSES[main] && ASCENDANCY_CLASSES[main].includes(sub)
                    )
                );
                if (!match) return false;
            } else {
                // 支援多值（以, 或 、分隔）
                const cell = (row[key] || '').split(/,|、/).map(s => s.trim());
                if (!filters[key].some(val => cell.includes(val))) return false;
            }
        }
        return true;
    }
    // 1. 新增對應表（請將圖片網址換成你自己的）
    const ASCENDANCY_IMAGES = {
        '勇士': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Juggernaut.png?key=9QcvWBwz82ssD8VPHWBMUA',
        '暴徒': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Berserker.png?key=wwrBpvaFm_G9pmy7yKtUGg',
        '酋長': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Chieftain.png?key=OigrIPPg6pUUcLD_h0uQFgimg/ascendancy_qiuzhang.png',
        '守林人': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Warden.png?key=41OaJS3vcJUhYFnvSRCfUw',
        '銳眼': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Deadeye.png?key=cXCSUiBfopA9ApEMtnYbLw',
        '追獵者': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Pathfinder.png?key=tdQf9JweYNzFfy3FgH9qpQ',
        '秘術家': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Occultist.png?key=mV3c0qbitkd9QJL1ZGZVXQ',
        '元素使': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Elementalist.png?key=xTQG41cKmhvNFrwu_cN7CQ',
        '死靈師': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Necromancer.png?key=elS-LvLYJzjIbJuOdVP5_g',
        '處刑者': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Slayer.png?key=GXdlR4sUMV-AsfrB9_hjHQ',
        '衛士': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Gladiator.png?key=09py0OfLrWjOVQIbfU1m6w',
        '冠軍': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Champion.png?key=tgo2quXqkaI3QGvIRJSi6Q',
        '判官': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Inquisitor.png?key=DhDuviNFcgwY_8QpofzRRg',
        '聖宗': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Hierophant.png?key=8QDOpgoGaZS0ksXADuoUKw',
        '守護者': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Guardian.png?key=dUCfULonJ5ihtjU8G0cDoA',
        '刺客': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Assassin.png?key=ZxaRbd_wAQJa1Ma_Yu-_cA',
        '詐欺師': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Trickster.png?key=xsXRx0faBRn5OiV5ghrnGQ',
        '破壞者': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Saboteur.png?key=j7PBS-x41WkhF32aQOT0bA',
        '昇華使徒': 'https://web.poecdn.com/protected/image/promo/ascendancy/classes/Ascendant.png?key=2-zRw53BEG3Ca-1BSn3_XQ'
    };

    // 2. 新增渲染函式
    function renderAscendancyCell(text) {
        if (!text) return '';
        // 支援多個昇華（以, 或 、分隔）
        return text.split(/,|、/).map(name => {
            name = name.trim();
            if (ASCENDANCY_IMAGES[name]) {
                // 調整這裡的 height、width
                return `<img src="${ASCENDANCY_IMAGES[name]}" alt="${name}" title="${name}" style="height:80px;width:auto;vertical-align:middle;margin:0 2px;">`;
            }
            return name;
        }).join('');
    }

    // 3. 修改 renderTable
    function renderTable(data, filters) {
        const tbody = document.querySelector('#games-table tbody');
        // 動畫：先淡出
        tbody.classList.add('fade');
        setTimeout(() => {
            tbody.innerHTML = '';
            data.filter(row => {
                if (Object.keys(filters).length === 0) return true;
                return matchFilters(row, filters);
            }).forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row['流派名稱']||''}</td>
                    <td>${renderAscendancyCell(row['昇華'])}</td>
                    <td>${row['擅長分類']||''}</td>
                    <td>${row['傷害類型']||''}</td>
                    <td>${row['作者']||''}</td>
                    <td>${embedVideo(row['影片連結'])}</td>
                    <td>${row['說明']||''}</td>
                `;
                tbody.appendChild(tr);
            });
            // 動畫：再淡入
            tbody.classList.remove('fade');
        }, 200);
    }
    function embedVideo(url) {
        if (!url) return '無影片連結';
        // 只支援 YouTube
        const ytMatch = url.match(/(?:youtu\.be\/|youtube\.com\/(?:watch\?v=|embed\/|v\/))([\w-]{11})/);
        if (!ytMatch) {
            return `<a href="${url}" target="_blank">查看影片</a>`;
        }
        const vid = ytMatch[1];
        const thumb = `https://img.youtube.com/vi/${vid}/hqdefault.jpg`;
        // 直接顯示縮圖，點擊彈窗
        return `<img src="${thumb}" class="video-thumb" data-vid="${vid}" style="cursor:pointer;max-width:120px;border-radius:8px;box-shadow:0 2px 12px #000a;">`;
    }

    const FIELD_MAP = ["流派名稱", "昇華", "擅長分類", "傷害類型", "作者", "影片連結", "說明"];

    function parseCSV(text) {
        const lines = text.split(/\r?\n/).filter(line => line.trim() !== '');
        const header = lines[0].split(',');
        return lines.slice(1).map(line => {
            const values = line.split(',');
            const obj = {};
            FIELD_MAP.forEach((key, idx) => {
                obj[key] = values[idx] || '';
            });
            return obj;
        });
    }

    async function loadCSVData() {
        try {
            const res = await fetch('data.csv?_=' + Date.now());
            if (!res.ok) throw new Error('無法載入 data.csv');
            const text = await res.text();
            const json = parseCSV(text);
            window._gameData = json;
            createModernFilters();
            renderTable(json, {});
        } catch (e) {
            console.error('載入 CSV 失敗', e);
            alert('載入 data.csv 失敗：' + e.message);
        }
    }

    window.onload = function () {
        loadCSVData();
    };

    // 建立預覽元素
    const preview = document.createElement('div');
    preview.style.position = 'fixed';
    preview.style.pointerEvents = 'none';
    preview.style.display = 'none';
    preview.style.zIndex = 9999;
    preview.innerHTML = '<img src="" style="max-width:240px;max-height:135px;border-radius:8px;box-shadow:0 2px 12px #000a;">';
    document.body.appendChild(preview);

    document.addEventListener('mouseover', function(e) {
        const link = e.target.closest('.video-link');
        if (link && link.dataset.thumb) {
            const img = preview.querySelector('img');
            img.src = link.dataset.thumb;
            preview.style.display = 'block';
        }
    });
    document.addEventListener('mousemove', function(e) {
        if (preview.style.display === 'block') {
            preview.style.left = (e.clientX + 20) + 'px';
            preview.style.top = (e.clientY + 20) + 'px';
        }
    });
    document.addEventListener('mouseout', function(e) {
        const link = e.target.closest('.video-link');
        if (link) {
            preview.style.display = 'none';
        }
    });

    // 彈窗播放影片
    const modalMask = document.getElementById('video-modal-mask');
    const modalIframe = document.getElementById('video-modal-iframe');
    const modalClose = document.getElementById('video-modal-close');

    document.addEventListener('click', function(e) {
        const thumb = e.target.closest('.video-thumb');
        if (thumb && thumb.dataset.vid) {
            modalMask.style.display = 'flex';
            modalIframe.src = `https://www.youtube.com/embed/${thumb.dataset.vid}?autoplay=1`;
        }
        if (e.target === modalMask || e.target === modalClose) {
            modalMask.style.display = 'none';
            modalIframe.src = '';
        }
    });
    </script>
</body>
</html>